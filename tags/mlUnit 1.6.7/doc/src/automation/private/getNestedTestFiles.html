<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getNestedTestFiles</title>
  <meta name="keywords" content="getNestedTestFiles">
  <meta name="description" content="GETNESTEDTESTFILES returns a list of all test_*.m files in all">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">src</a> &gt; <a href="../index.html">automation</a> &gt; <a href="index.html">private</a> &gt; getNestedTestFiles.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\automation\private&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>getNestedTestFiles
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>GETNESTEDTESTFILES returns a list of all test_*.m files in all</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function suitespecs = getNestedTestFiles(basedir) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> GETNESTEDTESTFILES returns a list of all test_*.m files in all
 subdirectories. The subdirectories are queried by genpath(). Therefore,
 subdirectories beginning with @ will be excluded.

 GETNESTEDTESTFILES(BASEDIR) returns a list of all test_*.m files in
 BASEDIR.

 The return value is a cell array of structures. Each structure contains:
     testname the name of the found test file
     fulldir  the absolute path of the containing directory
     reldir   the relative path of the containing directory, set back
              against the basedir input argument</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="dirset.html" class="code" title="function absdirs = dirset(basedir, depth_first)">dirset</a>	DIRSET Find directories, recursively.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function bIsClass = isclassdir(name)</a></li><li><a href="#_sub2" class="code">function name = clean_classname(name)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function suitespecs = getNestedTestFiles(basedir)</a>
0002 <span class="comment">% GETNESTEDTESTFILES returns a list of all test_*.m files in all</span>
0003 <span class="comment">% subdirectories. The subdirectories are queried by genpath(). Therefore,</span>
0004 <span class="comment">% subdirectories beginning with @ will be excluded.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% GETNESTEDTESTFILES(BASEDIR) returns a list of all test_*.m files in</span>
0007 <span class="comment">% BASEDIR.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% The return value is a cell array of structures. Each structure contains:</span>
0010 <span class="comment">%     testname the name of the found test file</span>
0011 <span class="comment">%     fulldir  the absolute path of the containing directory</span>
0012 <span class="comment">%     reldir   the relative path of the containing directory, set back</span>
0013 <span class="comment">%              against the basedir input argument</span>
0014 
0015 <span class="comment">%  This Software and all associated files are released unter the</span>
0016 <span class="comment">%  GNU General Public License (GPL), see LICENSE for details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%  $Author: hetu $</span>
0019 <span class="comment">%  $Id: getNestedTestFiles.m 71 2013-12-14 10:39:02Z hetu $</span>
0020 
0021    <span class="comment">% get list of directories</span>
0022    dirlist = <a href="dirset.html" class="code" title="function absdirs = dirset(basedir, depth_first)">dirset</a>(basedir);
0023    
0024    <span class="comment">% build relative dir name for each directory name</span>
0025    reldirlist = strrep(dirlist, basedir, <span class="string">''</span>);     <span class="comment">% crop basedir</span>
0026    
0027    <span class="comment">% search pattern</span>
0028    search_prefix = <span class="string">'test_'</span>;
0029    search_suffix = <span class="string">'.m'</span>;
0030    
0031    suitespecs = [];
0032    
0033    <span class="comment">% get files from each directory</span>
0034    <span class="keyword">for</span> iDir = 1:numel(dirlist)
0035       
0036       <span class="comment">% get test class item</span>
0037       [classpath classname classext] = fileparts(dirlist{iDir});
0038       <span class="keyword">if</span> <a href="#_sub1" class="code" title="subfunction bIsClass = isclassdir(name)">isclassdir</a>(classname)
0039           <span class="keyword">if</span> isequal(1, strmatch(search_prefix, <a href="#_sub2" class="code" title="subfunction name = clean_classname(name)">clean_classname</a>(classname)))
0040               spec = struct();
0041               spec.testname = classname;
0042               spec.reldir = strrep(classpath, basedir, <span class="string">''</span>);
0043               spec.fulldir = classpath;
0044               suitespecs{end+1} = spec;
0045           <span class="keyword">end</span>
0046           <span class="keyword">continue</span>;
0047       <span class="keyword">end</span>
0048        
0049       <span class="comment">% get list of test files</span>
0050       files = dir(dirlist{iDir});
0051       ids = strmatch(search_prefix, {files.name});
0052       tests = {files(ids).name};
0053       
0054       <span class="keyword">for</span> iFile = 1:numel(tests)
0055          [path name ext] = fileparts(tests{iFile});
0056          <span class="keyword">if</span> strcmp(ext, search_suffix)
0057             
0058             spec = struct();
0059             spec.testname = name;
0060             spec.reldir = reldirlist{iDir};
0061             spec.fulldir = dirlist{iDir};
0062 
0063             suitespecs{end+1} = spec;
0064          <span class="keyword">end</span>
0065       <span class="keyword">end</span>
0066    <span class="keyword">end</span>
0067 
0068    
0069 <a name="_sub1" href="#_subfunctions" class="code">function bIsClass = isclassdir(name)</a>
0070 
0071     bIsClass = ~isempty(name) &amp;&amp; strcmp(name(1), <span class="string">'@'</span>);
0072 
0073 <a name="_sub2" href="#_subfunctions" class="code">function name = clean_classname(name)</a>
0074 
0075     <span class="keyword">if</span> ~isempty(name)
0076         name = name(2:end);
0077     <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 08-Jan-2015 14:45:03 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>